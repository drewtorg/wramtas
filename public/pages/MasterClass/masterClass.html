<div>
  <h2>Virtual Master Class</h2>
  <div ng-show="!masterClass.inEditMode">
    <div ng-show="masterClassComing()">
      <div ng-bind-html="trustAsHtml(masterClass.preHtml)"
            class="margin-bottom">
      </div>
    </div>
    <div ng-show="masterClassInProgress()">
      <div ng-bind-html="trustAsHtml(masterClass.html)" class="margin-bottom">
      </div>
      <youtube-video video-url="masterClass.url"></youtube-video>
      <button ng-hide="isAdmin()"
              class="btn btn-primary"
              ng-click="openSurvey()">
        Take Survey <span class="glyphicon glyphicon-edit"></span>
      </button>
    </div>
    <div ng-show="masterClassOver()">
      <p>
        There is currently no Virtual Master Class. We will be giving more 
        information about the next Virtual Master Class shortly.
      </p>
    </div>
  </div>
  <div ng-show="isAdmin()">
    <div ng-hide="masterClass.inEditMode">
      <button class="btn btn-primary"
              ng-click="editMasterClass()">
        Edit Master Class <span class="glyphicon glyphicon-edit"></span>
      </button>
      <button class="btn btn-primary"
              ng-click="editSurvey()">
        Edit Survey <span class="glyphicon glyphicon-edit"></span>
      </button>
    </div>
    <div ng-show="masterClass.inEditMode" class="margin-top">
      <label>Message before Master Class</label>
      <textarea ui-tinymce="tinymceOptions" ng-model="tempMasterClass.preHtml">
      </textarea>
      <br/>
      <label>Message during Master Class</label>
      <textarea ui-tinymce="tinymceOptions" ng-model="tempMasterClass.html">
      </textarea>
      <label class="control-label margin-top">YouTube Link</label>
      <input type="text"
             class="form-control"
             ng-model="tempMasterClass.url"
             placeholder="Youtube URL" />
      <div class="row margin-top">
        <div class="col-md-6">
          <label class="control-label">Start Time:</label>
          <p class="input-group">
            <input type="text"
                   class="form-control"
                   uib-datepicker-popup="{{format}}"
                   ng-model="tempMasterClass.dates.openDate.date"
                   is-open="tempMasterClass.dates.openDate.opened"
                   datepicker-options="datepickerOptions"
                   close-text="Close" />
            <span class="input-group-btn">
              <button type="button"
                      class="btn btn-default"
                      ng-click="toggleOpened(tempMasterClass.dates.openDate)">
                <i class="glyphicon glyphicon-calendar"></i>
              </button>
            </span>
          </p>
        </div>
        <div class="col-md-6">
          <label class="control-label">End Time:</label>
          <p class="input-group">
            <input type="text"
                   class="form-control"
                   uib-datepicker-popup="{{format}}"
                   ng-model="tempMasterClass.dates.closeDate.date"
                   is-open="tempMasterClass.dates.closeDate.opened"
                   datepicker-options="datepickerOptions"
                   close-text="Close" />
            <span class="input-group-btn">
              <button type="button"
                      class="btn btn-default"
                      ng-click="toggleOpened(tempMasterClass.dates.closeDate)">
                <i class="glyphicon glyphicon-calendar"></i>
              </button>
            </span>
          </p>
        </div>
      </div>
      <button class="btn btn-success" ng-click="saveMasterClass()">
        Save Changes <span class="glyphicon glyphicon-floppy-disk"></span>
      </button>
      <button class="btn btn-danger" ng-click="undoEdits()">
        Undo Changes <span class="glyphicon glyphicon-remove"></span>
      </button>
    </div>
    <hr/>
    <div ng-if="masterClass.survey">
      <h2>Survey Results</h2>
      <div ng-repeat="s in masterClass.survey">
        <h4>Question #{{$index + 1}}: {{s.question}}</h4>
        <div class="survey-responses">
          <div ng-if="s.inputType === 'text' || s. inputType === 'textarea'">
            <table class="table table-bordered table-striped">
              <tr>
                <th>Responses</th>
              </tr>
              <tr ng-repeat="response in s.responses">
                <td>{{response}}</td>
              </tr>
            </table>
          </div>
          <div ng-if="s.inputType === 'radio' || s.inputType === 'select' || s.inputType === 'checkbox'">
            <table class="table table-bordered table-striped">
              <tr>
                <th>Responses</th>
                <th>Results</th>
              </tr>
              <tr ng-repeat="option in s.validOptions">
                <td>{{option}}</td>
                <td>{{s.tallies[$index]}}</td>
              </tr>
            </table>
          </div>
        </div>
        <hr/>
      </div>
      <h4>Total Video Views: {{masterClass.ipAddresses.length}}</h4>
      <button class="btn btn-danger" ng-click="clearVideoCount()">
        Clear Count <span class="glyphicon glyphicon-remove"></span>
      </button>
    </div>
  </div>
</div>
